Search.setIndex({"alltitles": {"Base Tokenizer": [[2, "base-tokenizer"]], "Causal Tokenization": [[5, "causal-tokenization"]], "Causal Tokenizer": [[2, "causal-tokenizer"]], "Configuration": [[2, "module-src.tasks.tokenization.tokenizer.config"]], "Configuration API": [[0, null]], "Configuration Options": [[4, "configuration-options"]], "Configuration via YAML": [[5, "configuration-via-yaml"]], "Core Components": [[5, "core-components"]], "Dataset": [[3, "module-src.utils.dataset.storage"]], "Distributed Training": [[1, "module-src.tasks.pretraining.fabric.distributed"]], "Example Usage": [[4, "example-usage"]], "FSDP Wrappers": [[1, "module-src.tasks.pretraining.fabric.wrappers.policies"]], "Fabric Base": [[1, "fabric-base"]], "Indices and tables": [[6, null]], "Key Concepts": [[5, null]], "Logging": [[1, "module-src.tasks.pretraining.fabric.logger"], [3, "module-src.utils.logging"]], "Model Generation": [[1, "model-generation"]], "Next Steps": [[4, "next-steps"], [5, "next-steps"]], "Notes": [[1, null], [3, null]], "Orchestrator": [[1, "module-src.tasks.pretraining.orchestrator"], [2, "orchestrator"]], "Orchestrator Base": [[3, "module-src.utils.orchestrator"]], "Performance Monitoring": [[1, "module-src.tasks.pretraining.fabric.speed_monitor"], [4, "performance-monitoring"]], "Performance Optimization": [[5, "performance-optimization"]], "Prerequisites": [[4, null]], "Pretraining API": [[1, null]], "Pretraining Architecture": [[4, "pretraining-architecture"]], "Pretraining Guide": [[4, null]], "Tokenization API": [[2, null]], "Tokenization Architecture": [[5, "tokenization-architecture"]], "Tokenization Guide": [[5, null]], "Tokenizer Statistics": [[5, "tokenizer-statistics"]], "Training Orchestration": [[4, "training-orchestration"]], "Usage with Pretraining": [[5, "usage-with-pretraining"]], "Utilities": [[1, "module-src.tasks.pretraining.utils"], [2, "utilities"]], "Utilities API": [[3, null]], "Version": [[3, "module-src.utils.version"]]}, "docnames": ["api/config/index", "api/tasks/pretraining", "api/tasks/tokenization", "api/utils/index", "guides/pretraining", "guides/tokenization", "index"], "envversion": {"nbsphinx": 4, "sphinx": 62, "sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.todo": 2, "sphinx.ext.viewcode": 1}, "filenames": ["api/config/index.rst", "api/tasks/pretraining.rst", "api/tasks/tokenization.rst", "api/utils/index.rst", "guides/pretraining.rst", "guides/tokenization.rst", "index.rst"], "indexentries": {"__init__() (src.config.config_loader.configvalidator method)": [[0, "src.config.config_loader.ConfigValidator.__init__", false]], "__init__() (src.tasks.pretraining.fabric.speed_monitor.speedmonitorbase method)": [[1, "src.tasks.pretraining.fabric.speed_monitor.SpeedMonitorBase.__init__", false]], "__init__() (src.tasks.pretraining.fabric.speed_monitor.speedmonitorcallback method)": [[1, "src.tasks.pretraining.fabric.speed_monitor.SpeedMonitorCallback.__init__", false]], "__init__() (src.tasks.pretraining.fabric.speed_monitor.speedmonitorfabric method)": [[1, "src.tasks.pretraining.fabric.speed_monitor.SpeedMonitorFabric.__init__", false]], "__init__() (src.tasks.tokenization.tokenizer.config.tokenizerconfig method)": [[2, "src.tasks.tokenization.tokenizer.config.TokenizerConfig.__init__", false]], "__init__() (src.utils.dataset.storage.datasetstorage method)": [[3, "src.utils.dataset.storage.DatasetStorage.__init__", false]], "__init__() (src.utils.orchestrator.baseorchestrator method)": [[3, "src.utils.orchestrator.BaseOrchestrator.__init__", false]], "baseorchestrator (class in src.utils.orchestrator)": [[3, "src.utils.orchestrator.BaseOrchestrator", false]], "batch_size (src.tasks.tokenization.tokenizer.config.tokenizerconfig attribute)": [[2, "id4", false], [2, "src.tasks.tokenization.tokenizer.config.TokenizerConfig.batch_size", false]], "colors (src.utils.logging.customformatter attribute)": [[3, "id5", false], [3, "src.utils.logging.CustomFormatter.COLORS", false]], "configvalidator (class in src.config.config_loader)": [[0, "src.config.config_loader.ConfigValidator", false]], "context_length (src.tasks.tokenization.tokenizer.config.tokenizerconfig attribute)": [[2, "id0", false], [2, "src.tasks.tokenization.tokenizer.config.TokenizerConfig.context_length", false]], "create_auto_wrap_policy() (in module src.tasks.pretraining.fabric.wrappers.policies)": [[1, "src.tasks.pretraining.fabric.wrappers.policies.create_auto_wrap_policy", false]], "customformatter (class in src.utils.logging)": [[3, "src.utils.logging.CustomFormatter", false]], "datasetstorage (class in src.utils.dataset.storage)": [[3, "src.utils.dataset.storage.DatasetStorage", false]], "debug (src.utils.logging.verboselevel attribute)": [[3, "id4", false], [3, "src.utils.logging.VerboseLevel.DEBUG", false]], "deterministic() (in module src.tasks.pretraining.utils)": [[1, "src.tasks.pretraining.utils.deterministic", false]], "display_version_info() (in module src.utils.version)": [[3, "src.utils.version.display_version_info", false]], "enable_txt_samples (src.utils.dataset.storage.datasetstorage attribute)": [[3, "id8", false], [3, "src.utils.dataset.storage.DatasetStorage.enable_txt_samples", false]], "errors (src.utils.logging.verboselevel attribute)": [[3, "id1", false], [3, "src.utils.logging.VerboseLevel.ERRORS", false]], "eval_end() (src.tasks.pretraining.fabric.speed_monitor.speedmonitorbase method)": [[1, "src.tasks.pretraining.fabric.speed_monitor.SpeedMonitorBase.eval_end", false]], "extension_to_method (src.utils.dataset.storage.datasetstorage attribute)": [[3, "id10", false], [3, "src.utils.dataset.storage.DatasetStorage.extension_to_method", false]], "format() (src.utils.logging.customformatter method)": [[3, "src.utils.logging.CustomFormatter.format", false]], "get_flops_available() (in module src.tasks.pretraining.fabric.speed_monitor)": [[1, "src.tasks.pretraining.fabric.speed_monitor.get_flops_available", false]], "get_logger() (in module src.utils.logging)": [[3, "src.utils.logging.get_logger", false]], "get_system_info() (in module src.utils.version)": [[3, "src.utils.version.get_system_info", false]], "get_transformer_layer_class() (in module src.tasks.pretraining.fabric.wrappers.policies)": [[1, "src.tasks.pretraining.fabric.wrappers.policies.get_transformer_layer_class", false]], "get_transformer_layer_class_from_model() (in module src.tasks.pretraining.fabric.wrappers.policies)": [[1, "src.tasks.pretraining.fabric.wrappers.policies.get_transformer_layer_class_from_model", false]], "get_version() (in module src.utils.version)": [[3, "src.utils.version.get_version", false]], "info (src.utils.logging.verboselevel attribute)": [[3, "id3", false], [3, "src.utils.logging.VerboseLevel.INFO", false]], "load_dataset() (src.utils.orchestrator.baseorchestrator method)": [[3, "src.utils.orchestrator.BaseOrchestrator.load_dataset", false]], "load_from_disk() (src.utils.dataset.storage.datasetstorage method)": [[3, "src.utils.dataset.storage.DatasetStorage.load_from_disk", false]], "load_from_hub() (src.utils.dataset.storage.datasetstorage method)": [[3, "src.utils.dataset.storage.DatasetStorage.load_from_hub", false]], "logger (src.utils.dataset.storage.datasetstorage attribute)": [[3, "id9", false], [3, "src.utils.dataset.storage.DatasetStorage.logger", false]], "module": [[0, "module-src.config.config_loader", false], [1, "module-src.tasks.pretraining.fabric.distributed", false], [1, "module-src.tasks.pretraining.fabric.logger", false], [1, "module-src.tasks.pretraining.fabric.speed_monitor", false], [1, "module-src.tasks.pretraining.fabric.wrappers.policies", false], [1, "module-src.tasks.pretraining.orchestrator", false], [1, "module-src.tasks.pretraining.utils", false], [2, "module-src.tasks.tokenization.tokenizer.config", false], [3, "module-src.utils.dataset.storage", false], [3, "module-src.utils.dataset.utils", false], [3, "module-src.utils.logging", false], [3, "module-src.utils.orchestrator", false], [3, "module-src.utils.version", false]], "none (src.utils.logging.verboselevel attribute)": [[3, "id0", false], [3, "src.utils.logging.VerboseLevel.NONE", false]], "num_proc (src.tasks.tokenization.tokenizer.config.tokenizerconfig attribute)": [[2, "src.tasks.tokenization.tokenizer.config.TokenizerConfig.num_proc", false]], "on_train_batch_end() (src.tasks.pretraining.fabric.speed_monitor.speedmonitorbase method)": [[1, "src.tasks.pretraining.fabric.speed_monitor.SpeedMonitorBase.on_train_batch_end", false]], "on_train_batch_end() (src.tasks.pretraining.fabric.speed_monitor.speedmonitorcallback method)": [[1, "src.tasks.pretraining.fabric.speed_monitor.SpeedMonitorCallback.on_train_batch_end", false]], "on_train_batch_end() (src.tasks.pretraining.fabric.speed_monitor.speedmonitorfabric method)": [[1, "src.tasks.pretraining.fabric.speed_monitor.SpeedMonitorFabric.on_train_batch_end", false]], "on_train_start() (src.tasks.pretraining.fabric.speed_monitor.speedmonitorcallback method)": [[1, "src.tasks.pretraining.fabric.speed_monitor.SpeedMonitorCallback.on_train_start", false]], "on_validation_end() (src.tasks.pretraining.fabric.speed_monitor.speedmonitorcallback method)": [[1, "src.tasks.pretraining.fabric.speed_monitor.SpeedMonitorCallback.on_validation_end", false]], "on_validation_start() (src.tasks.pretraining.fabric.speed_monitor.speedmonitorcallback method)": [[1, "src.tasks.pretraining.fabric.speed_monitor.SpeedMonitorCallback.on_validation_start", false]], "overlap (src.tasks.tokenization.tokenizer.config.tokenizerconfig attribute)": [[2, "id1", false], [2, "src.tasks.tokenization.tokenizer.config.TokenizerConfig.overlap", false]], "process_files() (src.utils.dataset.storage.datasetstorage method)": [[3, "src.utils.dataset.storage.DatasetStorage.process_files", false]], "reset (src.utils.logging.customformatter attribute)": [[3, "id6", false], [3, "src.utils.logging.CustomFormatter.RESET", false]], "save_to_disk() (src.utils.dataset.storage.datasetstorage method)": [[3, "src.utils.dataset.storage.DatasetStorage.save_to_disk", false]], "scan_directory() (in module src.utils.dataset.utils)": [[3, "src.utils.dataset.utils.scan_directory", false]], "select_optimizer() (in module src.tasks.pretraining.utils)": [[1, "src.tasks.pretraining.utils.select_optimizer", false]], "select_scheduler() (in module src.tasks.pretraining.utils)": [[1, "src.tasks.pretraining.utils.select_scheduler", false]], "set_logger_level() (in module src.utils.logging)": [[3, "src.utils.logging.set_logger_level", false]], "setup() (src.tasks.pretraining.fabric.speed_monitor.speedmonitorcallback method)": [[1, "src.tasks.pretraining.fabric.speed_monitor.SpeedMonitorCallback.setup", false]], "show_progress (src.tasks.tokenization.tokenizer.config.tokenizerconfig attribute)": [[2, "src.tasks.tokenization.tokenizer.config.TokenizerConfig.show_progress", false]], "speedmonitorbase (class in src.tasks.pretraining.fabric.speed_monitor)": [[1, "src.tasks.pretraining.fabric.speed_monitor.SpeedMonitorBase", false]], "speedmonitorcallback (class in src.tasks.pretraining.fabric.speed_monitor)": [[1, "src.tasks.pretraining.fabric.speed_monitor.SpeedMonitorCallback", false]], "speedmonitorfabric (class in src.tasks.pretraining.fabric.speed_monitor)": [[1, "src.tasks.pretraining.fabric.speed_monitor.SpeedMonitorFabric", false]], "split() (src.utils.dataset.storage.datasetstorage method)": [[3, "src.utils.dataset.storage.DatasetStorage.split", false]], "src.config.config_loader": [[0, "module-src.config.config_loader", false]], "src.tasks.pretraining.fabric.distributed": [[1, "module-src.tasks.pretraining.fabric.distributed", false]], "src.tasks.pretraining.fabric.logger": [[1, "module-src.tasks.pretraining.fabric.logger", false]], "src.tasks.pretraining.fabric.speed_monitor": [[1, "module-src.tasks.pretraining.fabric.speed_monitor", false]], "src.tasks.pretraining.fabric.wrappers.policies": [[1, "module-src.tasks.pretraining.fabric.wrappers.policies", false]], "src.tasks.pretraining.orchestrator": [[1, "module-src.tasks.pretraining.orchestrator", false]], "src.tasks.pretraining.utils": [[1, "module-src.tasks.pretraining.utils", false]], "src.tasks.tokenization.tokenizer.config": [[2, "module-src.tasks.tokenization.tokenizer.config", false]], "src.utils.dataset.storage": [[3, "module-src.utils.dataset.storage", false]], "src.utils.dataset.utils": [[3, "module-src.utils.dataset.utils", false]], "src.utils.logging": [[3, "module-src.utils.logging", false]], "src.utils.orchestrator": [[3, "module-src.utils.orchestrator", false]], "src.utils.version": [[3, "module-src.utils.version", false]], "step_csv_logger() (in module src.tasks.pretraining.fabric.logger)": [[1, "src.tasks.pretraining.fabric.logger.step_csv_logger", false]], "tokenizer_name (src.tasks.tokenization.tokenizer.config.tokenizerconfig attribute)": [[2, "id2", false], [2, "src.tasks.tokenization.tokenizer.config.TokenizerConfig.tokenizer_name", false]], "tokenizerconfig (class in src.tasks.tokenization.tokenizer.config)": [[2, "src.tasks.tokenization.tokenizer.config.TokenizerConfig", false]], "validate() (src.config.config_loader.configvalidator method)": [[0, "src.config.config_loader.ConfigValidator.validate", false]], "verbose_level (src.tasks.tokenization.tokenizer.config.tokenizerconfig attribute)": [[2, "id3", false], [2, "src.tasks.tokenization.tokenizer.config.TokenizerConfig.verbose_level", false]], "verbose_level (src.utils.dataset.storage.datasetstorage attribute)": [[3, "id7", false], [3, "src.utils.dataset.storage.DatasetStorage.verbose_level", false]], "verboselevel (class in src.utils.logging)": [[3, "src.utils.logging.VerboseLevel", false]], "warnings (src.utils.logging.verboselevel attribute)": [[3, "id2", false], [3, "src.utils.logging.VerboseLevel.WARNINGS", false]]}, "objects": {"src.config": [[0, 0, 0, "-", "config_loader"]], "src.config.config_loader": [[0, 1, 1, "", "ConfigValidator"]], "src.config.config_loader.ConfigValidator": [[0, 2, 1, "", "__init__"], [0, 2, 1, "", "validate"]], "src.tasks.pretraining": [[1, 0, 0, "-", "orchestrator"], [1, 0, 0, "-", "utils"]], "src.tasks.pretraining.fabric": [[1, 0, 0, "-", "distributed"], [1, 0, 0, "-", "logger"], [1, 0, 0, "-", "speed_monitor"]], "src.tasks.pretraining.fabric.logger": [[1, 3, 1, "", "step_csv_logger"]], "src.tasks.pretraining.fabric.speed_monitor": [[1, 1, 1, "", "SpeedMonitorBase"], [1, 1, 1, "", "SpeedMonitorCallback"], [1, 1, 1, "", "SpeedMonitorFabric"], [1, 3, 1, "", "get_flops_available"]], "src.tasks.pretraining.fabric.speed_monitor.SpeedMonitorBase": [[1, 2, 1, "", "__init__"], [1, 2, 1, "", "eval_end"], [1, 2, 1, "", "on_train_batch_end"]], "src.tasks.pretraining.fabric.speed_monitor.SpeedMonitorCallback": [[1, 2, 1, "", "__init__"], [1, 2, 1, "", "on_train_batch_end"], [1, 2, 1, "", "on_train_start"], [1, 2, 1, "", "on_validation_end"], [1, 2, 1, "", "on_validation_start"], [1, 2, 1, "", "setup"]], "src.tasks.pretraining.fabric.speed_monitor.SpeedMonitorFabric": [[1, 2, 1, "", "__init__"], [1, 2, 1, "", "on_train_batch_end"]], "src.tasks.pretraining.fabric.wrappers": [[1, 0, 0, "-", "policies"]], "src.tasks.pretraining.fabric.wrappers.policies": [[1, 3, 1, "", "create_auto_wrap_policy"], [1, 3, 1, "", "get_transformer_layer_class"], [1, 3, 1, "", "get_transformer_layer_class_from_model"]], "src.tasks.pretraining.utils": [[1, 3, 1, "", "deterministic"], [1, 3, 1, "", "select_optimizer"], [1, 3, 1, "", "select_scheduler"]], "src.tasks.tokenization.tokenizer": [[2, 0, 0, "-", "config"]], "src.tasks.tokenization.tokenizer.config": [[2, 1, 1, "", "TokenizerConfig"]], "src.tasks.tokenization.tokenizer.config.TokenizerConfig": [[2, 2, 1, "", "__init__"], [2, 4, 1, "id4", "batch_size"], [2, 4, 1, "id0", "context_length"], [2, 4, 1, "", "num_proc"], [2, 4, 1, "id1", "overlap"], [2, 4, 1, "", "show_progress"], [2, 4, 1, "id2", "tokenizer_name"], [2, 4, 1, "id3", "verbose_level"]], "src.utils": [[3, 0, 0, "-", "logging"], [3, 0, 0, "-", "orchestrator"], [3, 0, 0, "-", "version"]], "src.utils.dataset": [[3, 0, 0, "-", "storage"], [3, 0, 0, "-", "utils"]], "src.utils.dataset.storage": [[3, 1, 1, "", "DatasetStorage"]], "src.utils.dataset.storage.DatasetStorage": [[3, 2, 1, "", "__init__"], [3, 4, 1, "id8", "enable_txt_samples"], [3, 4, 1, "id10", "extension_to_method"], [3, 2, 1, "", "load_from_disk"], [3, 2, 1, "", "load_from_hub"], [3, 4, 1, "id9", "logger"], [3, 2, 1, "", "process_files"], [3, 2, 1, "", "save_to_disk"], [3, 2, 1, "", "split"], [3, 4, 1, "id7", "verbose_level"]], "src.utils.dataset.utils": [[3, 3, 1, "", "scan_directory"]], "src.utils.logging": [[3, 1, 1, "", "CustomFormatter"], [3, 1, 1, "", "VerboseLevel"], [3, 3, 1, "", "get_logger"], [3, 3, 1, "", "set_logger_level"]], "src.utils.logging.CustomFormatter": [[3, 4, 1, "id5", "COLORS"], [3, 4, 1, "id6", "RESET"], [3, 2, 1, "", "format"]], "src.utils.logging.VerboseLevel": [[3, 4, 1, "id4", "DEBUG"], [3, 4, 1, "id1", "ERRORS"], [3, 4, 1, "id3", "INFO"], [3, 4, 1, "id0", "NONE"], [3, 4, 1, "id2", "WARNINGS"]], "src.utils.orchestrator": [[3, 1, 1, "", "BaseOrchestrator"]], "src.utils.orchestrator.BaseOrchestrator": [[3, 2, 1, "", "__init__"], [3, 2, 1, "", "load_dataset"]], "src.utils.version": [[3, 3, 1, "", "display_version_info"], [3, 3, 1, "", "get_system_info"], [3, 3, 1, "", "get_version"]]}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "function", "Python function"], "4": ["py", "attribute", "Python attribute"]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:function", "4": "py:attribute"}, "terms": {"": [1, 2, 3, 5], "0": [1, 3, 4], "0e": 4, "0m": 3, "1": [1, 2, 3, 4], "10": 3, "100": 1, "1000": 5, "100000": 4, "100000000": 1, "11008": 4, "1_7b": 4, "2": [3, 4, 5], "20": 3, "2000": 4, "2f": [4, 5], "3": [2, 3, 4, 5], "30": 3, "31m": 3, "32": 4, "32000": [4, 5], "32m": 3, "3339": 3, "33m": 3, "35m": 3, "36m": 3, "3b": 5, "4": [3, 4], "40": 3, "4096": 4, "50": [3, 4], "512": 5, "6": 4, "7b": 4, "8": [4, 5], "A": [0, 1, 3, 5, 6], "Be": 1, "For": [2, 3, 5], "If": [0, 1, 2, 3], "It": [1, 2, 3], "No": 3, "The": [0, 1, 2, 3, 4, 5], "There": 1, "_": 4, "__init__": [0, 1, 2, 3], "__name__": 3, "abc": 3, "about": [3, 4], "abov": 3, "absolut": 0, "abstract": 3, "access": [0, 4], "accord": 3, "account": 1, "accumul": [1, 4], "across": [1, 4], "activ": 4, "activation_checkpoint": 4, "activation_checkpointing_polici": 4, "ad": 3, "adam": 1, "add": 3, "add_prefix_spac": 5, "add_special_token": 5, "addit": 3, "advanc": [4, 5, 6], "against": 0, "aggreg": 0, "algorithm": 5, "all": [0, 1], "allow": [2, 3], "almost": 1, "also": 3, "altern": 5, "alwai": 1, "among": 3, "an": [0, 1, 3, 5], "analysi": 5, "analyz": 5, "analyze_token": 5, "ani": [1, 3], "ansi": 3, "api": [4, 5], "applic": 3, "approach": 1, "appropri": [1, 3, 4, 5], "ar": [0, 1, 2, 3, 5], "architectur": [1, 6], "arg": 1, "argument": [1, 3], "around": [4, 5], "arrow": 3, "assum": [1, 2], "attent": 5, "attention_mask": 5, "attribut": [0, 1], "auto": [1, 4], "avail": [0, 2], "averag": [1, 5], "avg_token_length": 5, "avoid": 3, "back": 1, "backend": [1, 4], "bar": 2, "base": [0, 4], "baseorchestr": 3, "basetoken": 5, "basic": 4, "batch": [1, 2, 5], "batch_idx": 1, "batch_siz": [1, 2, 4, 5], "batches_per_sec": 1, "befor": 1, "behavior": 1, "beta": 1, "beta1": 1, "beta2": 1, "between": 5, "block": 1, "bool": [2, 3], "boolean": 3, "bos_token": 5, "both": 2, "box": [0, 3], "bpe": [5, 6], "build": [1, 3, 5, 6], "built": [4, 5], "byte": 5, "callabl": 1, "callback": 1, "can": [1, 2, 3, 4, 5], "capabl": [4, 5], "care": 1, "causal": 6, "causaltoken": 5, "chang": 3, "charact": 5, "check": [4, 5], "checkpoint": 4, "checkpoint_activ": 4, "circumst": 1, "cl": 1, "class": [0, 1, 2, 3, 4, 5], "clear": 2, "clip_grad_norm": 4, "code": 3, "coeffici": 1, "collect": [1, 3], "color": 3, "combin": 1, "common": 1, "commun": 4, "compar": 1, "compat": 4, "complet": [4, 5], "compon": [1, 2], "composit": 5, "comprehens": 6, "comput": [1, 4], "concaten": 3, "concept": 4, "config": [0, 2, 3, 4, 5], "config_load": [0, 4, 5], "config_path": 0, "configur": [1, 3, 6], "configvalid": 0, "consid": 2, "consist": 0, "consolid": 3, "constant": 1, "construct": 0, "constructor": 1, "contain": [0, 1, 3], "context": 2, "context_length": 2, "contigu": 4, "continu": [2, 5], "continual_llama_3": 4, "control": 2, "convert": 5, "core": 2, "corpu": 5, "corpus_fil": 5, "correspond": [0, 1, 3], "cosin": 4, "cover": 4, "coverag": 5, "cpu": [2, 4], "creat": [1, 3], "create_auto_wrap_polici": 1, "creation": 1, "criteria": 3, "crucial": 5, "csv": [1, 3], "csvlogger": 1, "cuda": 1, "current": 3, "custom": [1, 3, 5, 6], "customformatt": 3, "customtoken": 5, "dai": 1, "data": [0, 1, 3, 4, 5], "dataclass": 2, "dataset": [1, 2, 5], "dataset_nam": 3, "datasetdict": 3, "datasetstorag": 3, "date": 3, "datefmt": 3, "ddp": [4, 6], "debug": 3, "decai": 1, "declar": 0, "decoderlay": 1, "deepspe": [4, 6], "default": [0, 1, 2, 3], "defin": [1, 2, 3], "definit": 0, "depend": 1, "describ": 3, "descript": 3, "design": 3, "desir": 3, "destin": 3, "detail": [0, 1, 2, 3, 4], "detect": 1, "determin": [1, 2], "determinist": 1, "devic": [1, 4], "dict": [1, 3], "dictionari": [0, 1, 3], "differ": 4, "directli": 3, "directori": [0, 3], "disabl": 3, "disk": 3, "displai": 3, "display_version_info": 3, "dist": 4, "distribut": [3, 4, 6], "divid": [1, 3], "do": 1, "document": [0, 1, 2, 3], "doe": 1, "dot": 0, "doubl": 3, "draft7valid": 0, "ds_config": 4, "duplic": 3, "dure": [0, 1, 2, 3, 4], "dynam": 1, "e": [1, 3], "each": 3, "eas": 3, "effect": 5, "effici": [4, 5], "either": [1, 3], "elaps": 1, "enabl": [0, 1, 2, 3, 4], "enable_txt_sampl": 3, "encapsul": 2, "encod": 5, "encoderlay": 1, "encount": 0, "end": 3, "enhanc": 3, "ensur": [0, 1, 2, 3], "entir": 3, "entri": 1, "enum": 2, "enumer": 3, "environ": 1, "eos_token": 5, "epoch": 1, "error": [0, 3], "escap": 3, "essenti": 2, "estim": 1, "estimated_flop": 1, "eval_elaps": 1, "eval_end": 1, "exampl": 5, "except": 0, "execut": 0, "exist": 3, "experi": [1, 4, 5], "explain": 5, "explicitli": 3, "explor": [4, 5], "extend": 3, "extens": [0, 3, 6], "extension_to_method": 3, "f": [4, 5], "fabric": 4, "face": 3, "fail": 0, "fall": 1, "fals": [3, 4], "familiar": 4, "fascin": 5, "fast": 2, "featur": [3, 4, 6], "fetch": 3, "file": [0, 1, 3, 4, 5], "file_config": 3, "files_path": 3, "filter": 3, "find_unused_paramet": 4, "first": 1, "fix": 1, "flag": [1, 3], "flexibl": [2, 4], "float": [1, 3], "flop": 1, "flops_avail": 1, "flops_per_batch": 1, "flops_per_sec": 1, "fmt": 3, "focus": 4, "folder": 3, "follow": [0, 1], "forc": 2, "foreach": 1, "format": [0, 3], "formatt": 3, "found": [0, 1], "fp16": 4, "fraction": 1, "framework": [3, 4, 5, 6], "from": [0, 3, 4, 5], "from_fil": 5, "fsdp": [4, 6], "fsdp_config": 4, "full": [3, 4], "full_shard": 4, "function": [1, 3], "futur": 3, "g": [1, 3], "gener": 5, "get": 3, "get_flops_avail": 1, "get_fsdp_config": 4, "get_logg": 3, "get_system_info": 3, "get_transformer_layer_class": 1, "get_transformer_layer_class_from_model": 1, "get_vers": 3, "given": [0, 1, 3], "gpt2": 1, "gpt2token": 5, "gpu": 1, "gradient": [1, 4], "gradient_accumulation_step": [1, 4], "group": 3, "ha": 1, "half": 2, "handl": [0, 3, 4, 5], "hardwar": [1, 4], "helper": [1, 3], "hfdataset": [1, 3], "hidden_s": 4, "hierarchi": [4, 5], "highli": 1, "homogen": [1, 4], "hour": [1, 4], "how": [2, 5], "hub": 3, "hug": 3, "huge_corpu": 5, "huggingfac": 3, "hyperparamet": 1, "i": [0, 1, 2, 3, 4, 5], "id": 5, "identifi": [0, 1, 2, 3], "ignor": 2, "immut": 2, "impact": 4, "implement": [1, 2, 3, 6], "import": [1, 4, 5], "improv": 2, "includ": [0, 1, 3, 4, 5], "index": [3, 6], "individu": 3, "info": [2, 3, 4], "inform": [3, 4, 5], "initi": [0, 1, 3, 4, 5], "input": 2, "inspect": 1, "instanc": [0, 1, 3], "instanti": 1, "int": [1, 2, 3, 5], "integr": [3, 5, 6], "intellig": 2, "intenum": 3, "interfac": 3, "intermediate_s": 4, "intern": [0, 2], "interv": 4, "invalid": 3, "iso8601": 3, "issu": 0, "iter": 1, "its": [1, 2, 3], "json": [0, 3, 4, 5], "kei": [0, 1, 3, 4, 6], "keyword": [1, 3], "kwarg": [1, 3], "l2": 1, "lambdalr": 1, "languag": [4, 5, 6], "larg": [2, 5], "large_corpu": 5, "larger": 2, "later": 0, "layer": 1, "learn": [1, 3, 4, 5, 6], "learning_r": 4, "length": [1, 2, 5], "length_fn": 1, "level": [2, 3], "leverag": [1, 3], "librari": 3, "lightn": 1, "lightningmodul": 1, "like": [1, 3], "linear": 1, "list": [3, 5], "llama": [1, 4, 5], "llamatoken": 5, "load": [0, 3, 4, 5], "load_config": [4, 5], "load_dataset": 3, "load_from_disk": 3, "load_from_hub": 3, "local": 3, "log": [2, 4, 6], "log_dict": 1, "log_interv": 4, "log_iter_interv": 1, "logger": [1, 3, 4], "logic": [3, 4], "logrecord": 3, "loop": 4, "lower": 4, "lowercas": 1, "lr": 1, "lr_schedul": [1, 4], "machin": [3, 5, 6], "mai": 1, "make": 3, "manag": [3, 4, 6], "mani": [1, 2], "map": [1, 3, 5], "mask": 5, "match": [1, 3], "max_length": 5, "max_position_embed": 4, "max_shard_s": 3, "max_step": 4, "maximum": [2, 3], "measur": 1, "measure_flop": 1, "memori": [2, 4, 5], "merg": 1, "merge_bi": 1, "messag": [0, 3], "method": [0, 1, 3], "metric": 4, "mfu": 1, "min_frequ": 5, "min_num_param": 1, "mind": 3, "minimum": 1, "minut": 1, "miss": 3, "mix": 4, "mixed_precis": 4, "ml": [3, 4, 5, 6], "mode": [2, 5], "model": [4, 5, 6], "model_nam": 1, "modifi": 3, "modul": [0, 1, 2, 3, 4, 6], "modular": [4, 5, 6], "monitor": [2, 6], "more": 2, "most": 1, "multi": 6, "multipl": [2, 3], "multiprocess": [2, 3], "must": 1, "name": [0, 1, 2, 3], "nccl": 4, "necessari": 3, "need": 3, "neither": 1, "new": 3, "nfc": 5, "nn": 1, "node": 6, "none": [0, 1, 2, 3], "normal": [1, 5], "notat": 0, "notifi": 3, "notimplementederror": 3, "num_attention_head": 4, "num_hidden_lay": 4, "num_proc": [2, 3], "num_shard": 3, "num_work": 5, "number": [1, 2, 3], "number_epoch": 1, "numer": 5, "numpi": 1, "object": [0, 1, 2, 3], "offer": 5, "offload": 4, "offload_optim": 4, "omit": 3, "on_train_batch_end": 1, "on_train_start": 1, "on_validation_end": 1, "on_validation_start": 1, "one": [1, 2, 3], "onli": [1, 3], "oper": 3, "optim": [1, 4, 6], "option": [1, 2, 3, 5], "orchestr": 5, "other": 1, "otherwis": 1, "our": 1, "out": [4, 5], "output": [1, 2, 3], "output_dir": 5, "output_path": 3, "over": 1, "overestim": 1, "overhead": 4, "overlap": 2, "overrid": [1, 3], "overridden": 1, "overview": [4, 5], "pad": [1, 5], "pad_token": 5, "page": 6, "pair": 5, "paradigm": 4, "parallel": [2, 4, 5], "paramet": [0, 1, 2, 3, 4], "parent": 3, "partial": [1, 3], "particularli": 2, "pass": [1, 5], "passthrough": 3, "path": [0, 2, 3], "per": 1, "perform": [2, 6], "pipelin": [0, 4, 5], "pl_modul": 1, "polici": 1, "posit": [1, 5], "potenti": 1, "precis": [1, 4], "predefin": 1, "prefix": 1, "preload": 0, "prepar": 4, "present": 1, "pretrain": 6, "pretraining_llama": 4, "pretrainingorchestr": [4, 5], "prevent": 3, "primari": 3, "print": [3, 5], "process": [1, 2, 3, 4, 5], "process_fil": 3, "produc": [1, 3], "progress": 2, "project": 1, "proper": 0, "provid": [0, 1, 2, 3, 4, 5], "py": [1, 2, 3], "python": [1, 2, 3], "pytorch": [1, 4], "rais": [0, 1, 3], "random": 1, "rank": 3, "rate": 1, "ratio": 3, "readabl": 3, "realist": 1, "recent": 1, "record": 3, "recurs": 3, "reduc": [4, 5], "refer": [0, 1, 2, 3], "refresolv": 0, "regular": 1, "relat": 1, "reli": 2, "reliabl": 1, "replac": 1, "repres": [1, 2, 3], "reproduc": [1, 5], "requir": 2, "reset": 3, "resolut": 0, "resolv": 0, "resourc": 4, "result": [1, 3], "retriev": 1, "return": [0, 1, 2, 3], "return_attention_mask": 5, "rfc": 3, "rms_norm_ep": 4, "robust": [3, 6], "roll": 1, "row": 1, "run": 1, "rust": 2, "same": 1, "sampl": [1, 3, 4], "samples_per_sec": 1, "samples_per_second": 4, "satisfi": 3, "save": [1, 3], "save_to_disk": 3, "scalabl": [3, 6], "scale": [4, 6], "scan": 3, "scan_directori": 3, "schedul": 1, "schema": 0, "schema_dir": 0, "schema_nam": 0, "schema_stor": 0, "seamlessli": 5, "search": 6, "sec": 1, "second": [1, 4], "see": 5, "seed": 1, "segment": 2, "select": 1, "select_optim": 1, "select_schedul": 1, "sequenc": 3, "serv": 1, "set": [1, 2, 3, 5], "set_logger_level": 3, "setup": [1, 4], "setup_ddp": 4, "setup_model_with_ddp": 4, "shard": [3, 4], "sharding_strategi": 4, "share": 1, "should": [2, 3], "show": 2, "show_progress": 2, "singl": 2, "size": [1, 2, 3, 4, 5], "slide": 2, "slow": 2, "sourc": [0, 1, 2, 3], "special": [3, 5], "special_token": 5, "specif": [0, 1, 2, 3], "specifi": [0, 1, 2, 3], "speed": 4, "speed_monitor": [1, 4], "speedmonitor": 4, "speedmonitorbas": 1, "speedmonitorcallback": 1, "speedmonitorfabr": 1, "sphinx": 3, "split": 3, "split_ratio": 3, "src": [0, 1, 2, 3, 4, 5], "stage": [1, 3, 4], "standard": 3, "start": [3, 4, 5], "stat": 5, "step": [0, 1], "step_count": 1, "step_csv_logg": 1, "storag": 3, "store": [0, 3], "str": [0, 1, 2, 3, 5], "strategi": 4, "stream": 5, "streamlin": 1, "string": 3, "style": 3, "sub": 1, "subclass": [1, 3], "subdirectori": [0, 3], "subfold": 3, "subsequ": 1, "subset": 3, "substr": 1, "subword": 5, "suggest": 1, "suitabl": 4, "support": [1, 3, 4, 6], "supported_extens": 3, "synchron": 4, "system": [0, 3, 5], "t": 1, "task": [0, 1, 2, 4, 5], "techniqu": [2, 4, 5, 6], "templat": 3, "termin": 3, "test": 5, "test_siz": 3, "text": [2, 3, 5], "text_kei": 3, "thei": 3, "them": [0, 1, 3], "thi": [0, 1, 2, 3, 4, 5], "those": 1, "three": 1, "through": [0, 1, 4], "throughout": 2, "throughput": 1, "time": [1, 2], "time_unit": [1, 4], "token": [0, 1, 4, 6], "tokenize_corpus_parallel": 5, "tokenize_corpus_stream": 5, "tokenized_dataset": 5, "tokenizer_custom": 5, "tokenizer_nam": 2, "tokenizerconfig": [2, 5], "tokens_per_sec": 1, "tool": [4, 5, 6], "torch": [1, 4], "total": [1, 5], "trace": 3, "train": [0, 3, 5, 6], "train_batch_s": 4, "train_dataset": 1, "train_elaps": 1, "train_loss": 1, "train_token": 5, "trainer": 1, "training_step": 4, "transform": [1, 4], "travers": 3, "tree": 3, "trigger": 1, "true": [1, 2, 3, 4, 5], "txt": [3, 5], "type": [0, 1, 2, 3, 4], "typic": [2, 3], "under": 1, "understand": [4, 5], "union": [1, 3], "unit": 1, "unk": 5, "unk_token": 5, "up": 3, "updat": [1, 3, 4], "uri": 0, "us": [0, 1, 2, 3, 4, 5], "usag": 2, "user": 3, "util": [0, 5, 6], "val": 1, "valid": [0, 1, 3, 5], "validation_fil": 5, "valu": [1, 2, 3], "valueerror": [0, 1, 3], "variou": [1, 3], "verbos": [2, 3], "verbose_level": [2, 3], "verboselevel": [2, 3], "via": [4, 6], "vocab_s": [4, 5], "vocabulari": [5, 6], "wa": 3, "want": 3, "warmup": 1, "warmup_const": 1, "warmup_linear": 1, "warmup_proport": 1, "warmup_step": 4, "warn": 3, "we": 1, "weight": 1, "weight_decai": [1, 4], "well": 3, "when": [0, 1, 2, 3], "where": [2, 3], "whether": 2, "which": [1, 3, 4], "whose": [1, 3], "widespread": 1, "window": 2, "window_s": [1, 4], "within": [1, 3], "without": 0, "wordpiec": [5, 6], "work": 1, "worker": 5, "workflow": 3, "world": 1, "world_siz": 1, "wrap": [1, 4], "wrap_polici": 1, "wrapper": 4, "write": 1, "x1b": 3, "yaml": [0, 4, 6], "you": 3, "your": [3, 4, 5], "zero": 4, "zero_optim": 4}, "titles": ["Configuration API", "Pretraining API", "Tokenization API", "Utilities API", "Pretraining Guide", "Tokenization Guide", "Indices and tables"], "titleterms": {"api": [0, 1, 2, 3], "architectur": [4, 5], "base": [1, 2, 3], "causal": [2, 5], "compon": 5, "concept": 5, "configur": [0, 2, 4, 5], "core": 5, "dataset": 3, "distribut": 1, "exampl": 4, "fabric": 1, "fsdp": 1, "gener": 1, "guid": [4, 5], "indic": 6, "kei": 5, "log": [1, 3], "model": 1, "monitor": [1, 4], "next": [4, 5], "note": [1, 3], "optim": 5, "option": 4, "orchestr": [1, 2, 3, 4], "perform": [1, 4, 5], "prerequisit": 4, "pretrain": [1, 4, 5], "statist": 5, "step": [4, 5], "tabl": 6, "token": [2, 5], "train": [1, 4], "usag": [4, 5], "util": [1, 2, 3], "version": 3, "via": 5, "wrapper": 1, "yaml": 5}})